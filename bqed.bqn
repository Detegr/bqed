While â† {ğ•©{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}ğ•¨@}Â´

# ANSI escape code
ansiesc â† @+27
enter â† @+13

# Laminate array of strings with ANSI escape and concatenate them together
Ansi â† âˆ¾ansiescâŠ¸âˆ¾âŒœ

# Move cursor down for one line
CursorDown â† {ğ•Š: cxâ†©1 â‹„ cyâ†©cy+1}

# Move cursor to a specific position
CursorTo â† â€¢OutRawâˆ˜(ansiescâˆ¾"["âˆ¾(â€¢Fmt 1âŠ¸âŠ‘)âˆ¾";"âˆ¾(â€¢Fmt âŠ‘)âˆ¾"H"âˆ˜âŠ¢)

# Put character to screen, update cursor
PutChar â† {cxâ†©cx+1 â‹„ â€¢OutRaw ğ•©}

# Restore terminal state and exit
Quit â† {â€¢SH "stty"â€¿"-raw"â€¿"echo" â‹„ â€¢Exit ğ•©}

# Special keycodes to react to
keys â† 'q'â€¿enter

# List of functions corresponding indices of `keys`
kfns â† Quitâ€¿CursorDownâ€¿PutChar

# Get function for keycode
Kfn â† âŠ‘keysâŠ¸âŠ

# Fetch terminal width and height using `tput`
# Evaluate with â€¢BQN to convert strings to integers
wâ†â€¢BQN 1âŠ‘â€¢SH "tput"â€¿"cols"
hâ†â€¢BQN 1âŠ‘â€¢SH "tput"â€¿"lines"

âŸ¨cx, cyâŸ© â† 1â€¿1

StatusStr â† {ğ•Š:
  style â† ansiescâˆ¾"[100;37m"
  s â† "<" âˆ¾ (â€¢Fmt cx) âˆ¾ "," âˆ¾ (â€¢Fmt cy) âˆ¾ ">"
  pad â† (w-cx+â‰ s)/" "
  styleâˆ¾sâˆ¾padâˆ¾ansiescâˆ¾"[0m"
}

DrawStatus â† {ğ•Š: CursorTo 1â€¿h â‹„ â€¢OutRaw StatusStr @ â‹„ CursorTo cxâ€¿cy}

# Put terminal to raw mode, disable echo
â€¢SH "stty"â€¿"raw"â€¿"-echo"

# Clear screen and position cursor to top
â€¢OutRaw Ansi "[2J"â€¿"[H"

While 1â€¿{ğ•¤
  DrawStatus @

  # Get a character and run a function for the input
  Kfnâ—¶kfns â€¢GetChar @
}
