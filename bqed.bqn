While â† {ğ•©{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}ğ•¨@}Â´

# Fetch terminal width and height using `tput`
# Evaluate with â€¢BQN to convert strings to integers
wâ†â€¢BQN 1âŠ‘â€¢SH "tput"â€¿"cols"
hâ†â€¢BQN 1âŠ‘â€¢SH "tput"â€¿"lines"

# Open file contents
f â† âŸ¨""âŸ©

# Reshape file contents into a screen size matrix
Scrn â† âˆ˜â€¿wâŠ¸â¥ŠÂ·âˆ¾wâŠ¸â†‘Â¨

# ANSI escape code
ansiesc â† @+27
enter â† @+13

# Laminate array of strings with ANSI escape and concatenate them together
Ansi â† âˆ¾ansiescâŠ¸âˆ¾âŒœ

# Create a new line: update cursor and add line to `f`
NewLine â† {ğ•Š: cxâ†©1 â‹„ cyâ†©(h-1)âŒŠcy+1 â‹„ fâ†©fâˆ¾<""}

# Move cursor to a specific position
CursorTo â† â€¢OutRawâˆ˜(ansiescâˆ¾"["âˆ¾(â€¢Fmt 1âŠ¸âŠ‘)âˆ¾";"âˆ¾(â€¢Fmt âŠ‘)âˆ¾"H"âˆ˜âŠ¢)

# Put character to screen, update cursor
PutChar â† {ğ•Šğ•©: fâ†©ğ•©{âˆ¾âŸœğ•¨âŒ¾((cy-1)âŠ¸âŠ‘)ğ•©}f â‹„ cxâ†©cx+1}

DrawEditor â† {ğ•Šğ•©: CursorTo 1â€¿1 â‹„ â€¢OutRawÂ¨ğ•© â‹„ CursorTo cxâ€¿cy}

# Restore terminal state and exit
Quit â† {â€¢SH "stty"â€¿"-raw"â€¿"echo" â‹„ â€¢Exit ğ•©}

# Special keycodes to react to
keys â† (@+17)â€¿enter

# List of functions corresponding indices of `keys`
kfns â† Quitâ€¿NewLineâ€¿PutChar

# Get function for keycode
Kfn â† âŠ‘keysâŠ¸âŠ

âŸ¨cx, cyâŸ© â† 1â€¿1

# Status bar contents
StatusStr â† {ğ•Š:
  style â† ansiescâˆ¾"[100;37m"
  s â† "<" âˆ¾ (â€¢Fmt cx) âˆ¾ "," âˆ¾ (â€¢Fmt cy) âˆ¾ ">" âˆ¾ " | <C-q> to exit"
  pad â† (w-â‰ s)/" "
  styleâˆ¾sâˆ¾padâˆ¾ansiescâˆ¾"[0m"
}

DrawStatus â† {ğ•Š: CursorTo 1â€¿h â‹„ â€¢OutRaw StatusStr @ â‹„ CursorTo cxâ€¿cy}

# Put terminal to raw mode, disable echo
â€¢SH "stty"â€¿"raw"â€¿"-echo"

# Clear screen and position cursor to top
â€¢OutRaw Ansi "[2J"â€¿"[H"

While 1â€¿{ğ•¤
  DrawEditor (Scrn f)
  DrawStatus @

  # Get a character and run a function for the input
  Kfnâ—¶kfns â€¢GetChar @
}
